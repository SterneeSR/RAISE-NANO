{% extends "base.html" %}
{% load static %}

{% block title %}Startups{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.3.0/css/all.min.css">
<style>
    .filter-container {
        display: flex;
        flex-wrap: wrap;
        justify-content: center;
        align-items: center;
        gap: 1rem;
        margin-bottom: 2rem;
    }
    .search-container {
        position: relative;
        flex-grow: 1;
        max-width: 600px;
    }
    .search-input, .filter-select {
        background-color: #21262d;
        color: white;
        padding: 10px 18px;
        border-radius: 6px;
        border: 1px solid #30363d;
        font-size: 1rem;
        width: 100%;
    }
    .search-icon {
        position: absolute;
        top: 50%;
        right: 15px;
        transform: translateY(-50%);
        color: #8b949e;
        background: none;
        border: none;
        cursor: pointer;
    }
    .filter-select {
        flex-grow: 1;
        max-width: 200px;
    }
    /* Responsive layout for mobile */
    @media (max-width: 768px) {
        .filter-container {
            flex-direction: column;
        }
        .search-container, .filter-select {
            width: 100%;
            max-width: none;
        }
    }
</style>
{% endblock %}

{% block content %}
<header class="HeadT">
    <h1>OUR STARTUPS</h1>
</header>

<form method="get" action="{% url 'startups:startups' %}" autocomplete="off" class="filter-container">
    <div class="search-container">
        <input
            type="text"
            id="startup-search"
            name="q"
            class="search-input"
            value="{{ q }}"
            placeholder="Search startups..."
        >
        <button type="submit" class="search-icon"><i class="fa fa-search"></i></button>
    </div>

    <select name="category" class="filter-select" onchange="this.form.submit()">
        <option value="">All Categories</option>
        {% for value, label in categories %}
            <option value="{{ value }}" {% if value == selected_category %}selected{% endif %}>
                {{ label }}
            </option>
        {% endfor %}
    </select>
</form>

<section class="startup-container" id="startup-container">
    {% for startup in startups %}
    <div class="startup-box" data-category="{{ startup.category }}" data-name="{{ startup.name|lower }}" data-description="{{ startup.description|lower }}">
        <div class="startup-logo">
            {% if startup.logo %}
                <img src="{{ startup.logo.url }}" alt="{{ startup.name }} logo">
            {% else %}
                <span class="no-logo-text">{{ startup.name|slice:":1" }}</span>
            {% endif %}
        </div>
        <h3>{{ startup.name }}</h3>
        <div class="st-tags">
            <span class="st-tag highlight1">{{ startup.get_category_display }}</span>
        </div>
        <p>{{ startup.description }}</p>
        <div class="st-contact-card">
            {% if startup.phone %}
                <p>☎️ {{ startup.phone }}</p>
            {% endif %}
            {% if startup.email %}
                <p><i class="fas fa-envelope" style="color:#d8a9ff;"></i> {{ startup.email }}</p>
            {% endif %}
            {% if startup.website %}
                <p><i class="fas fa-globe" style="color:#52a0ff;"></i>
                    <a href="{{ startup.website }}" target="_blank">{{ startup.website }}</a>
                </p>
            {% endif %}
            <div class="st-social-icons">
                {% if startup.twitter %}<a href="{{ startup.twitter }}" target="_blank"><i class="fab fa-twitter"></i></a>{% endif %}
                {% if startup.instagram %}<a href="{{ startup.instagram }}" target="_blank"><i class="fab fa-instagram"></i></a>{% endif %}
                {% if startup.linkedin %}<a href="{{ startup.linkedin }}" target="_blank"><i class="fab fa-linkedin"></i></a>{% endif %}
                {% if startup.facebook %}<a href="{{ startup.facebook }}" target="_blank"><i class="fab fa-facebook"></i></a>{% endif %}
                {% if startup.youtube %}<a href="{{ startup.youtube }}" target="_blank"><i class="fab fa-youtube"></i></a>{% endif %}
            </div>
            <div class="more-info">
                {% if startup.info_img %}
                <button class="more-btn" data-image="{{ startup.info_img.url }}">More Info</button>{% endif %}
            </div>
        </div>
    </div>
    {% empty %}
        <p>No startups found for your search.</p>
    {% endfor %}
</section>

<div id="imagePopup" class="popup-overlay">
    <div class="popup-content">
        <span class="close-button">&times;</span>
        <img id="popupImage" src="" alt="Startup Image">
    </div>
</div>
{% endblock %}

{% block extra_js %}<script src="{% static 'startups/startups.js' %}" defer></script>{% endblock %}